<!-- public/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Spotify Party Viewer</title>
  <style>
    body {
      font-family: sans-serif;
      background: #121212;
      color: white;
      padding: 30px;
    }
    h1 {
      color: #1db954;
    }
    button {
      padding: 10px 20px;
      margin: 10px 5px;
      font-size: 16px;
      background: #1db954;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .user-block {
      margin-bottom: 30px;
      padding: 15px;
      border: 1px solid #1db954;
      border-radius: 10px;
    }
    .track-list {
      margin-top: 10px;
      padding-left: 20px;
    }
    .track-list li {
      margin: 5px 0;
    }
  </style>
</head>
<body>
  <h1>ðŸŽµ Spotify Party Viewer</h1>
  <button onclick="window.location.href='/login'">Login with Spotify</button>
  <button onclick="loadUsers()">Show Logged In Users</button>

  <div id="userContainer"></div>

  <script>
    async function loadUsers() {
      const res = await fetch("/users");
      const users = await res.json();

      const container = document.getElementById("userContainer");
      container.innerHTML = "";

      if (users.length === 0) {
        container.innerHTML = "<p>No users have logged in yet.</p>";
        return;
      }

      users.forEach((user, i) => {
        const userDiv = document.createElement("div");
        userDiv.className = "user-block";

        const name = document.createElement("h2");
        name.textContent = `#${i + 1}: ${user.name} (Logged in at ${user.loginTime})`;
        userDiv.appendChild(name);

        const trackList = document.createElement("ul");
        trackList.className = "track-list";
        user.topTracks.forEach(track => {
          const li = document.createElement("li");
          li.innerHTML = `${track.name} by ${track.artists} - <a href="${track.url}" target="_blank">Play</a>`;
          trackList.appendChild(li);
        });

        userDiv.appendChild(trackList);
        container.appendChild(userDiv);
      });
    }
  </script>
</body>
</html>
